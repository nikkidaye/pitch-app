{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nclass SessionStorage {\n  constructor(config, storage) {\n    this.config = config;\n    this.storageId = null;\n\n    try {\n      this.storage = storage || sessionStorage;\n    } catch (e) {}\n  }\n\n  storageKey(type, key) {\n    return \"\".concat(this.storageId, \"::\").concat(type, \"::\").concat(key);\n  }\n\n  get isReady() {\n    return this.config.sessionStorageEnabled && !!this.storageId;\n  }\n\n  updateStorageId(storageId) {\n    this.storageId = storageId;\n  }\n\n  store(type, id, value) {\n    if (!this.isReady) {\n      return null;\n    }\n\n    return this._store(this.storageKey(type, id), value);\n  }\n\n  read(type, id) {\n    if (!this.isReady) {\n      return null;\n    }\n\n    return this._read(this.storageKey(type, id));\n  }\n\n  remove(type, sid, uniqueName) {\n    if (!this.isReady) {\n      return null;\n    }\n\n    try {\n      this.storage.removeItem(this.storageKey(type, sid));\n\n      if (uniqueName) {\n        this.storage.removeItem(this.storageKey(type, uniqueName));\n      }\n    } catch (e) {}\n  }\n\n  update(type, sid, uniqueName, patch) {\n    if (!this.isReady) {\n      return null;\n    } // Currently cache may have root stored twice - by sid and by uniqueName\n    // Maybe need to create some index if needed\n\n\n    this._apply(this.storageKey(type, sid), patch);\n\n    if (uniqueName) {\n      this._apply(this.storageKey(type, uniqueName), patch);\n    }\n  }\n\n  _store(key, value) {\n    try {\n      this.storage.setItem(key, JSON.stringify(value));\n    } catch (e) {}\n  }\n\n  _read(key) {\n    try {\n      let storedData = this.storage.getItem(key);\n\n      if (storedData) {\n        return JSON.parse(storedData);\n      }\n    } catch (e) {}\n\n    return null;\n  }\n\n  _apply(key, patch) {\n    let value = this._read(key);\n\n    if (!value) {\n      return false;\n    }\n\n    this._store(key, Object.assign(value, patch));\n  }\n\n}\n\nexports.SessionStorage = SessionStorage;","map":null,"metadata":{},"sourceType":"script"}